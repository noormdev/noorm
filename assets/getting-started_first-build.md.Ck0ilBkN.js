import{_ as i,c as a,o as e,a6 as t}from"./chunks/framework.YF6eQPX_.js";const c=JSON.parse('{"title":"First Build","description":"","frontmatter":{},"headers":[],"relativePath":"getting-started/first-build.md","filePath":"getting-started/first-build.md"}'),n={name:"getting-started/first-build.md"};function l(h,s,p,d,r,k){return e(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="first-build" tabindex="-1">First Build <a class="header-anchor" href="#first-build" aria-label="Permalink to “First Build”">​</a></h1><p>This tutorial takes about 5 minutes. By the end, you&#39;ll understand how noorm separates <strong>schema definition</strong> from <strong>schema evolution</strong>.</p><h2 id="what-you-ll-do" tabindex="-1">What You&#39;ll Do <a class="header-anchor" href="#what-you-ll-do" aria-label="Permalink to “What You&#39;ll Do”">​</a></h2><ol><li>Initialize a project and configure a database</li><li>Create SQL files and build your schema</li><li>Evolve the schema with a change</li><li>Create a fresh test database to see you don&#39;t need migrations</li></ol><h2 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to “Prerequisites”">​</a></h2><ul><li>noorm installed (<a href="/getting-started/installation.html">Installation Guide</a>)</li><li>A PostgreSQL database to connect to</li></ul><h2 id="step-1-initialize-your-project" tabindex="-1">Step 1: Initialize Your Project <a class="header-anchor" href="#step-1-initialize-your-project" aria-label="Permalink to “Step 1: Initialize Your Project”">​</a></h2><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noorm-tutorial</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noorm-tutorial</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">noorm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init</span></span></code></pre></div><p>This creates the project structure:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>noorm-tutorial/</span></span>
<span class="line"><span>├── .noorm/</span></span>
<span class="line"><span>│   ├── settings.yml       # Project settings (commit this)</span></span>
<span class="line"><span>│   └── state.enc          # Encrypted state (don&#39;t commit)</span></span>
<span class="line"><span>├── sql/                   # Your SQL files go here</span></span>
<span class="line"><span>└── changes/               # Versioned changes go here</span></span></code></pre></div><h2 id="step-2-add-a-database-config" tabindex="-1">Step 2: Add a Database Config <a class="header-anchor" href="#step-2-add-a-database-config" aria-label="Permalink to “Step 2: Add a Database Config”">​</a></h2><p>Launch the TUI:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">noorm</span></span></code></pre></div><p>Press <code>c</code> for config, then <code>a</code> to add a new config. Fill out the form:</p><ul><li><strong>Config Name</strong>: <code>dev</code></li><li><strong>Database Type</strong>: PostgreSQL (use arrow keys to select)</li><li><strong>Host</strong>: <code>localhost</code></li><li><strong>Port</strong>: <code>5432</code></li><li><strong>Database</strong>: <code>noorm_dev</code></li><li><strong>Username</strong>: <code>postgres</code></li><li><strong>Password</strong>: your password</li></ul><p>Leave the SQL Path and Changes Path at their defaults (<code>./sql</code> and <code>./changes</code>). Submit the form to save your config.</p><h2 id="step-3-create-the-database" tabindex="-1">Step 3: Create the Database <a class="header-anchor" href="#step-3-create-the-database" aria-label="Permalink to “Step 3: Create the Database”">​</a></h2><p>Back at the home screen, press <code>d</code> for Database. You&#39;ll see the Database Operations screen:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>Database Operations</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Config:      dev</span></span>
<span class="line"><span>Connection:  CONNECTED</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Available Actions</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[c] Create - Build database from SQL files</span></span>
<span class="line"><span>[d] Destroy - Drop all managed objects</span></span>
<span class="line"><span>[x] Explore - Browse database schema</span></span>
<span class="line"><span>[w] Wipe - Truncate table data (keep schema)</span></span>
<span class="line"><span>[t] Teardown - Drop user objects (keep noorm)</span></span></code></pre></div><p>Press <code>c</code> to create. noorm will create the <code>noorm_dev</code> database on your PostgreSQL server and initialize its tracking tables.</p><div class="tip custom-block"><p class="custom-block-title">No SQL Files Yet?</p><p>That&#39;s fine! At this point we&#39;re just creating the empty database and noorm&#39;s internal tracking tables. We&#39;ll add SQL files next.</p></div><h2 id="step-4-configure-build-settings" tabindex="-1">Step 4: Configure Build Settings <a class="header-anchor" href="#step-4-configure-build-settings" aria-label="Permalink to “Step 4: Configure Build Settings”">​</a></h2><p>Open <code>.noorm/settings.yml</code> and define which folders to include:</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">paths</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  sql</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">./sql</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  changes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">./changes</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">01_tables</span></span></code></pre></div><p>The <code>include</code> array filters which folders are included in builds. Folder names are relative to your <code>paths.sql</code> directory.</p><div class="warning custom-block"><p class="custom-block-title">Execution Order</p><p>Files and directories run in <strong>alphanumeric order</strong>. Without numeric prefixes:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>sql/functions/   ← runs first (alphabetically)</span></span>
<span class="line"><span>sql/tables/      ← runs second</span></span>
<span class="line"><span>sql/views/       ← runs third</span></span></code></pre></div><p>That&#39;s wrong—tables should exist before views reference them. Use numeric prefixes:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>sql/01_tables/   ← runs first</span></span>
<span class="line"><span>sql/02_views/    ← runs second</span></span>
<span class="line"><span>sql/03_functions/ ← runs third</span></span></code></pre></div><p>This rule applies everywhere: directories, files within directories, change scripts. One mental model for everything.</p></div><h2 id="step-5-create-your-first-sql-file" tabindex="-1">Step 5: Create Your First SQL File <a class="header-anchor" href="#step-5-create-your-first-sql-file" aria-label="Permalink to “Step 5: Create Your First SQL File”">​</a></h2><p>Create the users table:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sql/01_tables</span></span></code></pre></div><p>Create <code>sql/01_tables/001_users.sql</code>:</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> EXISTS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SERIAL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TEXT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    email </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TEXT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNIQUE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    created_at </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TIMESTAMP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DEFAULT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h2 id="step-6-run-build" tabindex="-1">Step 6: Run Build <a class="header-anchor" href="#step-6-run-build" aria-label="Permalink to “Step 6: Run Build”">​</a></h2><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">noorm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre></div><p>Output:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>• build:start    Starting schema build (1 files)</span></span>
<span class="line"><span>• file:after     Executed sql/01_tables/001_users.sql (12ms)</span></span>
<span class="line"><span>• log            Build completed successfully  filesRun=1 filesSkipped=0</span></span></code></pre></div><p>Your users table now exists.</p><h2 id="step-7-evolve-the-schema" tabindex="-1">Step 7: Evolve the Schema <a class="header-anchor" href="#step-7-evolve-the-schema" aria-label="Permalink to “Step 7: Evolve the Schema”">​</a></h2><p>Now you want to expand the schema: add a <code>bio</code> column to users, create a posts table, and add a view.</p><p>First, <strong>update your SQL files</strong> to reflect the new ideal state.</p><p>Edit <code>sql/01_tables/001_users.sql</code>:</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> EXISTS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SERIAL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TEXT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    email </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TEXT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UNIQUE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bio </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TEXT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    created_at </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TIMESTAMP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DEFAULT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>Create <code>sql/01_tables/002_posts.sql</code>:</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> EXISTS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> posts (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SERIAL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    user_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INTEGER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> REFERENCES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users(id),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    title </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TEXT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    body </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TEXT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    created_at </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TIMESTAMP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DEFAULT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>Create <code>sql/02_views/001_recent_posts.sql</code>:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sql/02_views</span></span></code></pre></div><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE OR REPLACE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> VIEW</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> recent_posts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AS</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> p.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> author_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> posts p</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users u </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">user_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">created_at</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOW</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> INTERVAL </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;7 days&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Since you added views, <strong>update your settings</strong> to include the new folder:</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">01_tables</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">02_views</span></span></code></pre></div><p>The <code>02_</code> prefix ensures views run after tables—important since views reference tables.</p><p>Your SQL files now represent the complete, ideal schema. But the dev database still only has the old users table.</p><h2 id="step-8-create-a-change" tabindex="-1">Step 8: Create a Change <a class="header-anchor" href="#step-8-create-a-change" aria-label="Permalink to “Step 8: Create a Change”">​</a></h2><p>Use the TUI to create a change:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">noorm</span></span></code></pre></div><p>Press <code>g</code> for changes, then <code>a</code> to add a new change. Enter a name like <code>add-posts-and-bio</code>.</p><p>The TUI creates the folder structure and shows:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>✓ Change &quot;2024-01-15-add-posts-and-bio&quot; created!</span></span>
<span class="line"><span>Created folder structure with template files.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[e] Edit in editor  [any] Back to list</span></span></code></pre></div><p>Press <code>e</code> to open the change folder in your editor, or navigate to it manually. Add these files:</p><p><code>changes/2024-01-15-add-posts-and-bio/change/001_add_bio.sql</code>:</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> COLUMN </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">IF</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> EXISTS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bio </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TEXT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p>Changes should be idempotent—safe to run on any database state. PostgreSQL&#39;s <code>IF NOT EXISTS</code> ensures this won&#39;t error if the column already exists.</p><p><code>changes/2024-01-15-add-posts-and-bio/change/002_schema.txt</code>:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>01_tables/002_posts.sql</span></span>
<span class="line"><span>02_views/001_recent_posts.sql</span></span></code></pre></div><p>The <code>.txt</code> file references your SQL files. When the change runs, it executes those files from your <code>sql/</code> directory.</p><h2 id="step-9-apply-the-change" tabindex="-1">Step 9: Apply the Change <a class="header-anchor" href="#step-9-apply-the-change" aria-label="Permalink to “Step 9: Apply the Change”">​</a></h2><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">noorm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> change</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ff</span></span></code></pre></div><p>Output:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>• change:start   Applying 2024-01-15-add-posts-and-bio</span></span>
<span class="line"><span>• file:after     Executed 001_add_bio.sql (8ms)</span></span>
<span class="line"><span>• file:after     Executed 01_tables/002_posts.sql (15ms)</span></span>
<span class="line"><span>• file:after     Executed 02_views/001_recent_posts.sql (6ms)</span></span>
<span class="line"><span>• change:after   Applied 2024-01-15-add-posts-and-bio</span></span>
<span class="line"><span>• log            Changes applied successfully  applied=1 skipped=0</span></span></code></pre></div><p>Your dev database now matches your SQL files.</p><h2 id="step-10-fresh-database-no-migrations-needed" tabindex="-1">Step 10: Fresh Database (No Migrations Needed) <a class="header-anchor" href="#step-10-fresh-database-no-migrations-needed" aria-label="Permalink to “Step 10: Fresh Database (No Migrations Needed)”">​</a></h2><p>Now create a test database to see the other path. In the TUI:</p><ol><li>Press <code>c</code> for Configurations, then <code>a</code> to add a new config named <code>test</code> pointing to <code>noorm_test</code></li><li>Use arrow keys to select the <code>test</code> config and press <code>Enter</code> to switch to it</li><li>Press <code>d</code> for Database, then <code>c</code> to create the database</li><li>Press <code>r</code> for Run SQL, then <code>b</code> for Build</li></ol><p>If you already have a test config and database set up, you can do this in headless mode:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">noorm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">noorm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre></div><p>Output:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>• build:start    Starting schema build (3 files)</span></span>
<span class="line"><span>• file:after     Executed sql/01_tables/001_users.sql (14ms)</span></span>
<span class="line"><span>• file:after     Executed sql/01_tables/002_posts.sql (11ms)</span></span>
<span class="line"><span>• file:after     Executed sql/02_views/001_recent_posts.sql (7ms)</span></span>
<span class="line"><span>• log            Build completed successfully  filesRun=3 filesSkipped=0</span></span></code></pre></div><p>The test database has the complete schema from your SQL files. No changes needed—they&#39;re only for evolving existing databases.</p><h2 id="what-just-happened" tabindex="-1">What Just Happened? <a class="header-anchor" href="#what-just-happened" aria-label="Permalink to “What Just Happened?”">​</a></h2><p>You experienced both paths:</p><table tabindex="0"><thead><tr><th>Scenario</th><th>Command</th><th>What Runs</th></tr></thead><tbody><tr><td>Fresh database</td><td><code>noorm run build</code></td><td>SQL files</td></tr><tr><td>Existing database</td><td><code>noorm change ff</code></td><td>Changes</td></tr></tbody></table><p>Your SQL files are the source of truth. Changes are the changelog of how you evolved existing databases to match them.</p><div class="tip custom-block"><p class="custom-block-title">The Workflow</p><ol><li>Update your SQL files to reflect the ideal schema</li><li>Create a change to evolve existing databases</li><li>Fresh databases just run build—no migration history needed</li></ol></div><h2 id="what-s-next" tabindex="-1">What&#39;s Next? <a class="header-anchor" href="#what-s-next" aria-label="Permalink to “What&#39;s Next?”">​</a></h2><ul><li><a href="/getting-started/concepts.html">Concepts</a> - Understand the full mental model</li><li><a href="/getting-started/building-your-sdk.html">Building Your SDK</a> - Wrap noorm in a TypeScript SDK for your apps</li><li><a href="/tui.html">TUI Quick Reference</a> - Navigate the terminal interface</li><li><a href="/guide/changes/overview.html">Changes Guide</a> - Versioned changes in depth</li></ul>`,83)])])}const g=i(n,[["render",l]]);export{c as __pageData,g as default};
